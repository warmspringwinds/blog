<!DOCTYPE html>
<html lang="en">
<head>
        <title>Dan's blog</title>
        <!-- Fonts -->
        <link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=The+Girl+Next+Door' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Marcellus' rel='stylesheet' type='text/css'>
        
        <!-- CSS -->
        <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
        <link rel="stylesheet" href="/theme/css/pygments.css" type="text/css" />
        <link rel="stylesheet" href="/theme/css/font-awesome.css" type="text/css" />
        <meta charset="utf-8" />
      

        <!-- Javascript-->
        <script async src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
        <script async type="text/javascript"> 
        $(function() {
            function invisibleMenu() {
                var now = 0;
                var pixels = 300;
                var opacity = -1;

                var move = function() {
                    now = $(window).scrollTop();
                    if (now > pixels && opacity !== 0)
                        opacity = 0;
                    else if (now < pixels){
                        // Depends on the position not if scrolls down or up
                        opacity = (1 - now/pixels);
                    }
                    $("div.navigation").css({"opacity": opacity});
                }
                $(window).scroll(move);
                move();
            }
            invisibleMenu();
          });
          </script> 
</head>

<body id="index" class="home">
     <div class="navigation">
        <ol class="nav">
          <li class="current"><a href="">Blog</a> </li>
          <li><a href="/archives.html">Archive</a></li>
          <li><a href="/tags.html">Tags</a> </li>
          <li><a href="">RSS</a> </li>
        </ol>
      </div>
        <header id="banner" class="body">
                <div class="banner"><a href="">Dan's blog <strong></strong></a></div>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
        </ul></nav><!-- /#menu -->
        <div class="box">
<section id="content" class="body">
  <header class="post">
    <h1 class="entry-title">
      Logistic Regression
    </h1>
  </header>
  <footer class="post-info">
    <abbr>
      Sat 13 December 2014 
         By <a class="url fn" href="/author/daniil.html">Daniil</a>
  
    </abbr>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Logistic regression is a discriminative classification model.</p>
<div class="section" id="types-of-classification-models">
<h2>Types of classification models</h2>
<p>There are tree types of classification models:</p>
<ol class="arabic">
<li><p class="first"><strong>Generative classification models</strong>: This approach models the class conditional densities
<span class="math">\(p(\textbf{x}|C_k)\)</span> and class priors <span class="math">\(p(C_k)\)</span>. And knowing these two quantities,
we can get the posterior class probabilities, using <a class="reference external" href="http://en.wikipedia.org/wiki/Bayes%27_theorem">Bayes' theorem</a>:</p>
<div class="math">
\begin{equation*}
p(C_k|\textbf{x}) = \frac{p(\textbf{x}|C_k)p(C_k)}{p(\textbf{x})}
\end{equation*}
</div>
<p>This model has more parameters and will spend more time on training with high dimensional data.
The marginal density <span class="math">\(p(\textbf{x})\)</span> can be used to detect new data points that has low probability and, therefore, our classification won't be precise in that case.</p>
</li>
<li><p class="first"><strong>Discriminative models</strong>: This models find <span class="math">\(p(C_k|\textbf{x})\)</span> probabilities directly.
In this case make decisions based only on the posterior class probabilities. Probabilites
can help for example in case when we have a point that has nearly equal probabilities for
each class. In that case we can avoid making decisions because they will be not so accurate.
We won't be able to do it when using discriminant functions that will be described in the next step.
This model is also easier to train than generative model.</p>
</li>
<li><p class="first"><strong>Discriminant function approach</strong>: Approach that is only has a discriminative function
<span class="math">\(f(\textbf{x})\)</span> that maps each input to some particular class <span class="math">\(C_k\)</span>. This approach
doesn't have a probabilistic interpretation and usually faster to train. You gain speed but loose
probabilistic interpretation that can be useful in some cases.</p>
</li>
</ol>
</div>
<div class="section" id="deriving-the-logistic-regression-equation">
<h2>Deriving the logistic regression equation</h2>
<p>First, let's consider the example of two classes. The posterior probability of class <span class="math">\(C_1\)</span>
can be written as:</p>
<div class="math">
\begin{equation*}
p(C_1|\textbf{x}) = \frac{p(\textbf{x}|C_1)p(C_1)}{p(\textbf{x}|C_1)p(C_1) + p(\textbf{x}|C_2)p(C_2)}
\end{equation*}
</div>
<p>Then, we will use a different presentation of the same equation:</p>
<div class="math">
\begin{equation*}
p(C_1|\textbf{x}) = \sigma(a(\textbf{x}))
\end{equation*}
</div>
<p>Where:</p>
<div class="math">
\begin{equation*}
\sigma(a) = \frac{1}{1 + e^{-a(\textbf{x})}}
\end{equation*}
</div>
<div class="math">
\begin{equation*}
a(\textbf{x}) = ln\left(\frac{p(\textbf{x}|C_1)p(C_1)}{p(\textbf{x}|C_2)p(C_2)}\right)
\end{equation*}
</div>
<p>This is the same equation and you can check that by substituting everything back.</p>
<p>And for the case of <span class="math">\(K\gt2\)</span>:</p>
<div class="math">
\begin{equation*}
p(C_k|\textbf{x}) = \frac{p(\textbf{x}|C_k)p(C_k)}{\sum_{j=1}^{K}p(\textbf{x}|C_j)p(C_j)}
\end{equation*}
</div>
<p>We will rewrite it as:</p>
<div class="math">
\begin{equation*}
p(C_k|\textbf{x}) = \frac{e^{~a_k(\textbf{x})}}{\sum_{j=1}^{K}e^{~a_j(\textbf{x})}}
\end{equation*}
</div>
<p>Where:</p>
<div class="math">
\begin{equation*}
:label:`eq`
\label{eq}a_j(\textbf{x}) = ln\left( p(\textbf{x}|C_j) p(C_j) \right)
\end{equation*}
</div>
<p>and then reference <span class="math">\(\ref{eq}\)</span></p>
<table class="docutils footnote" frame="void" id="barber" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Barber book</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="murphy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Murpy book</td></tr>
</tbody>
</table>
</div>
<script type='text/javascript'>if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }
    
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
  </div><!-- /.entry-content -->
</section>
            <hr/>
            <footer id="contentinfo" class="footer">
                <div>
                    <a href="">Daniil</a> (2012)
                </div>
                <div>
                    This work is licensed under <a rel="license" href="http://opensource.org/licenses/bsd-3-clause">3 clause BSD</a>. Source code available on <a rel="source code" href="https://github.com/slok/blog">Github</a>
                </div>
                <div>
                    powered by <a href="http://getpelican.com/">Pelican</a>
                    and <a href="http://python.org">Python</a>. 
                    <a href="http://github.com/slok/iris">Theme</a> by <a href="http://xlarrakoetxea.org">Xabier Larrakoetxea</a> based on <a href="http://flask.pocoo.org/">Flask</a> theme
                </div>
                <div>
                    Social icons (font awesome) by <a href="http://fortawesome.github.com/Font-Awesome/"> fort awesome</a>.
                    <a href="http://www.google.com/webfonts/specimen/The+Girl+Next+Door">Title</a>, <a href="http://www.google.com/webfonts/specimen/Marcellus">headers</a> and <a href="http://www.google.com/webfonts/specimen/Inconsolata">source code</a> fonts by google fonts
                </div>
                <div class="social">
                        <a href="#"><i class="icon-You can add links in your config file"></i>  </a>
                        <a href="#"><i class="icon-Another social link"></i>  </a>
                        <a href="http://github.com/warmspringwinds"><i class="icon-github"></i>  </a>
                        <a href="mailto:warmspringwinds@gmail.com"><i class="icon-envelope"></i> </a>
                </div>
            </footer><!-- /#contentinfo -->
        </div>
        <!--Add statistycs-->

</body>
</html>